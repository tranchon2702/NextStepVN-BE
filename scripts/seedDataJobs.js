const mongoose = require('mongoose');
const dotenv = require('dotenv');
dotenv.config();

const { Job, CompanyInfo, ContactHR } = require('../models/Careers');

const MONGO_URI = 'mongodb://localhost:27017/saigon3jean';

async function seedJobs() {
  try {
    console.log('üîÑ Connecting to MongoDB...');
    await mongoose.connect(MONGO_URI, {
      useNewUrlParser: true,
      useUnifiedTopology: true
    });
    console.log('üì¶ Connected to MongoDB');

    // X√≥a t·∫•t c·∫£ jobs c≈©
    await Job.deleteMany({});
    console.log('‚úÖ Cleared old jobs');

    // Seed jobs m·ªõi v·ªõi ƒë·∫ßy ƒë·ªß th√¥ng tin
    const jobs = [
      // C∆† KH√ç
      {
        jobCode: 'KSD_1',
        title: 'K·ªπ s∆∞ thi·∫øt k·∫ø c∆° kh√≠ s·∫£n ph·∫©m m·ªÅm Catia V5',
        category: 'C∆† KH√ç',
        location: 'Shizuoka-ken, Nh·∫≠t B·∫£n',
        workType: 'Full-time',
        description: 'Thi·∫øt k·∫ø c√°c s·∫£n ph·∫©m m·ªÅm cho d√¢y truy·ªÅn s·∫£n xu·∫•t t·ª± ƒë·ªông s·ª≠ d·ª•ng ph·∫ßn m·ªÅm Catia V5',
        requirements: [
          'T·ªët nghi·ªáp ƒë·∫°i h·ªçc chuy√™n ng√†nh C∆° kh√≠',
          'C√≥ kinh nghi·ªám s·ª≠ d·ª•ng Catia V5 t·ªëi thi·ªÉu 2 nƒÉm',
          'C√≥ kinh nghi·ªám thi·∫øt k·∫ø m·∫°ch ƒëi·ªán',
          'Ti·∫øng Nh·∫≠t N3 tr·ªü l√™n ho·∫∑c c√≥ kh·∫£ nƒÉng giao ti·∫øp c∆° b·∫£n'
        ],
        benefits: [
          'B·∫£o hi·ªÉm y t·∫ø, x√£ h·ªôi ƒë·∫ßy ƒë·ªß',
          'H·ªó tr·ª£ nh√† ·ªü',
          'Xe ƒë∆∞a ƒë√≥n',
          'TƒÉng l∆∞∆°ng ƒë·ªãnh k·ª≥'
        ],
        salary: {
          min: 300000,
          max: 450000,
          currency: '¬•',
          note: 'T√πy theo nƒÉng l·ª±c v√† kinh nghi·ªám'
        },
        bonus: 'Th∆∞·ªüng theo hi·ªáu su·∫•t c√¥ng vi·ªác',
        allowance: 'Tr·ª£ c·∫•p nh√† ·ªü, ƒëi l·∫°i',
        otherBenefits: 'H·ªó tr·ª£ chi ph√≠ h·ªçc ti·∫øng Nh·∫≠t, du l·ªãch h√†ng nƒÉm',
        major: 'K·ªπ thu·∫≠t c∆° kh√≠',
        age: {
          min: 22,
          max: 35
        },
        experience: 'C√≥ kinh nghi·ªám thi·∫øt k·∫ø m·∫°ch ƒëi·ªán',
        language: 'Ti·∫øng Nh·∫≠t N3 tr·ªü l√™n ho·∫∑c c√≥ kh·∫£ nƒÉng giao ti·∫øp c∆° b·∫£n',
        overtime: 'C√≥ th·ªÉ c√≥ overtime trong cao ƒëi·ªÉm',
        offTime: 'Th·ª© 7, Ch·ªß nh·∫≠t v√† c√°c ng√†y l·ªÖ',
        interviewFormat: 'Online ho·∫∑c tr·ª±c ti·∫øp t·∫°i Vi·ªát Nam',
        interviewTime: 'Linh ho·∫°t theo l·ªãch ·ª©ng vi√™n',
        otherInfo: 'C√¥ng ty h·ªó tr·ª£ visa v√† chi ph√≠ sang Nh·∫≠t',
        assignedTo: 'ƒêang c·∫≠p nh·∫≠t',
        recruitmentStatus: 'ƒêang tuy·ªÉn',
        isActive: true,
        isFeatured: true,
        order: 1
      },
      {
        jobCode: 'KSX_2',
        title: 'K·ªπ s∆∞ c∆° kh√≠ s·∫£n xu·∫•t',
        category: 'C∆† KH√ç',
        location: 'Tokyo, Nh·∫≠t B·∫£n',
        workType: 'Full-time',
        description: 'Qu·∫£n l√Ω v√† gi√°m s√°t quy tr√¨nh s·∫£n xu·∫•t c∆° kh√≠, ƒë·∫£m b·∫£o ch·∫•t l∆∞·ª£ng s·∫£n ph·∫©m',
        requirements: [
          'T·ªët nghi·ªáp ƒë·∫°i h·ªçc C∆° kh√≠',
          'C√≥ kinh nghi·ªám 2 nƒÉm trong s·∫£n xu·∫•t',
          'Ti·∫øng Nh·∫≠t N2'
        ],
        benefits: [
          'L∆∞∆°ng c·∫°nh tranh',
          'B·∫£o hi·ªÉm ƒë·∫ßy ƒë·ªß',
          'Th∆∞·ªüng cu·ªëi nƒÉm'
        ],
        salary: {
          min: 280000,
          max: 420000,
          currency: '¬•'
        },
        major: 'C∆° kh√≠',
        age: {
          min: 24,
          max: 40
        },
        language: 'Ti·∫øng Nh·∫≠t N2',
        recruitmentStatus: 'ƒêang tuy·ªÉn',
        isActive: true,
        order: 2
      },

      // √î T√î
      {
        jobCode: 'OTO_1',
        title: 'K·ªπ s∆∞ thi·∫øt k·∫ø chi ti·∫øt √¥ t√¥',
        category: '√î T√î',
        location: 'Shizuoka-ken, Nh·∫≠t B·∫£n',
        workType: 'Full-time',
        description: 'Thi·∫øt k·∫ø chi ti·∫øt c√°c b·ªô ph·∫≠n √¥ t√¥ s·ª≠ d·ª•ng ph·∫ßn m·ªÅm CAD',
        requirements: [
          'T·ªët nghi·ªáp ƒë·∫°i h·ªçc chuy√™n ng√†nh √î t√¥ ho·∫∑c C∆° kh√≠',
          'C√≥ kinh nghi·ªám thi·∫øt k·∫ø √¥ t√¥',
          'Ti·∫øng Nh·∫≠t N3 tr·ªü l√™n'
        ],
        benefits: [
          'B·∫£o hi·ªÉm ƒë·∫ßy ƒë·ªß',
          'H·ªó tr·ª£ nh√† ·ªü',
          'Du l·ªãch h√†ng nƒÉm'
        ],
        salary: {
          min: 320000,
          max: 480000,
          currency: '¬•'
        },
        major: '√î t√¥ / C∆° kh√≠',
        age: {
          min: 23,
          max: 38
        },
        language: 'Ti·∫øng Nh·∫≠t N3 tr·ªü l√™n',
        recruitmentStatus: 'ƒêang tuy·ªÉn',
        isActive: true,
        order: 3
      },
      {
        jobCode: 'RD_OTO_1',
        title: 'K·ªπ s∆∞ R&D √î t√¥',
        category: '√î T√î',
        location: 'Yokohama, Nh·∫≠t B·∫£n',
        workType: 'Full-time',
        description: 'Nghi√™n c·ª©u v√† ph√°t tri·ªÉn c√¥ng ngh·ªá √¥ t√¥ m·ªõi, xe ƒëi·ªán',
        requirements: [
          'Th·∫°c sƒ© C∆° kh√≠ ho·∫∑c √î t√¥',
          'C√≥ kinh nghi·ªám R&D',
          'Ti·∫øng Nh·∫≠t N2 ho·∫∑c ti·∫øng Anh t·ªët'
        ],
        benefits: [
          'M√¥i tr∆∞·ªùng l√†m vi·ªác hi·ªán ƒë·∫°i',
          'C∆° h·ªôi ph√°t tri·ªÉn ngh·ªÅ nghi·ªáp',
          'L∆∞∆°ng th∆∞·ªüng h·∫•p d·∫´n'
        ],
        salary: {
          min: 350000,
          max: 500000,
          currency: '¬•'
        },
        major: 'C∆° kh√≠ / √î t√¥',
        age: {
          min: 25,
          max: 40
        },
        language: 'Ti·∫øng Nh·∫≠t N2 ho·∫∑c ti·∫øng Anh t·ªët',
        recruitmentStatus: 'ƒêang tuy·ªÉn',
        isActive: true,
        order: 4
      },

      // ƒêI·ªÜN - ƒêI·ªÜN T·ª¨
      {
        jobCode: 'DIEN_1',
        title: 'K·ªπ s∆∞ ƒëi·ªán t·ª≠ c√¥ng nghi·ªáp',
        category: 'ƒêI·ªÜN, ƒêI·ªÜN T·ª¨',
        location: 'Osaka, Nh·∫≠t B·∫£n',
        workType: 'Full-time',
        description: 'Thi·∫øt k·∫ø v√† b·∫£o tr√¨ h·ªá th·ªëng ƒëi·ªán t·ª≠ c√¥ng nghi·ªáp',
        requirements: [
          'T·ªët nghi·ªáp ƒë·∫°i h·ªçc ƒêi·ªán - ƒêi·ªán t·ª≠',
          'C√≥ kinh nghi·ªám l√†m vi·ªác v·ªõi PLC',
          'Ti·∫øng Nh·∫≠t N3'
        ],
        benefits: [
          'B·∫£o hi·ªÉm y t·∫ø, x√£ h·ªôi',
          'Th∆∞·ªüng theo hi·ªáu su·∫•t',
          'H·ªó tr·ª£ ƒë√†o t·∫°o'
        ],
        salary: {
          min: 290000,
          max: 430000,
          currency: '¬•'
        },
        major: 'ƒêi·ªán - ƒêi·ªán t·ª≠',
        age: {
          min: 22,
          max: 35
        },
        language: 'Ti·∫øng Nh·∫≠t N3',
        recruitmentStatus: 'ƒêang tuy·ªÉn',
        isActive: true,
        order: 5
      },
      {
        jobCode: 'IOT_1',
        title: 'K·ªπ s∆∞ IoT v√† t·ª± ƒë·ªông h√≥a',
        category: 'ƒêI·ªÜN, ƒêI·ªÜN T·ª¨',
        location: 'Nagoya, Nh·∫≠t B·∫£n',
        workType: 'Full-time',
        description: 'Ph√°t tri·ªÉn gi·∫£i ph√°p IoT cho nh√† m√°y th√¥ng minh',
        requirements: [
          'T·ªët nghi·ªáp ƒë·∫°i h·ªçc ƒêi·ªán t·ª≠ ho·∫∑c IT',
          'C√≥ kinh nghi·ªám v·ªÅ IoT, sensors',
          'Ti·∫øng Nh·∫≠t N2'
        ],
        benefits: [
          'M√¥i tr∆∞·ªùng c√¥ng ngh·ªá cao',
          'ƒê√†o t·∫°o chuy√™n s√¢u',
          'C∆° h·ªôi thƒÉng ti·∫øn'
        ],
        salary: {
          min: 330000,
          max: 470000,
          currency: '¬•'
        },
        major: 'ƒêi·ªán t·ª≠ / IT',
        age: {
          min: 24,
          max: 38
        },
        language: 'Ti·∫øng Nh·∫≠t N2',
        recruitmentStatus: 'ƒêang tuy·ªÉn',
        isActive: true,
        order: 6
      },

      // IT
      {
        jobCode: 'DEV_1',
        title: 'Full Stack Developer',
        category: 'IT',
        location: 'Tokyo, Nh·∫≠t B·∫£n',
        workType: 'Full-time',
        description: 'Ph√°t tri·ªÉn web application s·ª≠ d·ª•ng React, Node.js',
        requirements: [
          'T·ªët nghi·ªáp ƒë·∫°i h·ªçc CNTT',
          'Th√†nh th·∫°o React, Node.js',
          'Ti·∫øng Nh·∫≠t N3 ho·∫∑c ti·∫øng Anh t·ªët'
        ],
        benefits: [
          'L√†m vi·ªác t·∫°i c√¥ng ty IT h√†ng ƒë·∫ßu',
          'L∆∞∆°ng cao, th∆∞·ªüng h·∫•p d·∫´n',
          'Work-life balance t·ªët'
        ],
        salary: {
          min: 350000,
          max: 550000,
          currency: '¬•'
        },
        major: 'C√¥ng ngh·ªá th√¥ng tin',
        age: {
          min: 22,
          max: 35
        },
        language: 'Ti·∫øng Nh·∫≠t N3 ho·∫∑c ti·∫øng Anh t·ªët',
        recruitmentStatus: 'ƒêang tuy·ªÉn',
        isActive: true,
        order: 7
      },
      {
        jobCode: 'AI_1',
        title: 'AI Engineer',
        category: 'IT',
        location: 'Tokyo, Nh·∫≠t B·∫£n',
        workType: 'Full-time',
        description: 'Ph√°t tri·ªÉn gi·∫£i ph√°p AI/ML cho c√°c d·ª± √°n c√¥ng nghi·ªáp',
        requirements: [
          'Th·∫°c sƒ© CNTT ho·∫∑c AI',
          'Kinh nghi·ªám Python, TensorFlow',
          'Ti·∫øng Anh t·ªët'
        ],
        benefits: [
          'M√¥i tr∆∞·ªùng l√†m vi·ªác qu·ªëc t·∫ø',
          'Package l∆∞∆°ng cao',
          'C∆° h·ªôi nghi√™n c·ª©u'
        ],
        salary: {
          min: 400000,
          max: 600000,
          currency: '¬•'
        },
        major: 'CNTT / AI',
        age: {
          min: 24,
          max: 40
        },
        language: 'Ti·∫øng Anh t·ªët',
        recruitmentStatus: 'ƒêang tuy·ªÉn',
        isActive: true,
        order: 8
      },

      // X√ÇY D·ª∞NG
      {
        jobCode: 'XD_1',
        title: 'K·ªπ s∆∞ x√¢y d·ª±ng d√¢n d·ª•ng',
        category: 'X√ÇY D·ª∞NG',
        location: 'Saitama, Nh·∫≠t B·∫£n',
        workType: 'Full-time',
        description: 'Thi·∫øt k·∫ø v√† gi√°m s√°t thi c√¥ng c√°c c√¥ng tr√¨nh d√¢n d·ª•ng',
        requirements: [
          'T·ªët nghi·ªáp ƒë·∫°i h·ªçc X√¢y d·ª±ng',
          'C√≥ kinh nghi·ªám 2 nƒÉm',
          'Ti·∫øng Nh·∫≠t N3'
        ],
        benefits: [
          'B·∫£o hi·ªÉm ƒë·∫ßy ƒë·ªß',
          'Th∆∞·ªüng d·ª± √°n',
          'H·ªó tr·ª£ ·ªü l·∫°i l√¢u d√†i'
        ],
        salary: {
          min: 300000,
          max: 450000,
          currency: '¬•'
        },
        major: 'X√¢y d·ª±ng',
        age: {
          min: 24,
          max: 40
        },
        language: 'Ti·∫øng Nh·∫≠t N3',
        recruitmentStatus: 'ƒêang tuy·ªÉn',
        isActive: true,
        order: 9
      },
      {
        jobCode: 'XD_2',
        title: 'K·ªπ s∆∞ c·∫ßu ƒë∆∞·ªùng',
        category: 'X√ÇY D·ª∞NG',
        location: 'Kanagawa, Nh·∫≠t B·∫£n',
        workType: 'Full-time',
        description: 'Thi·∫øt k·∫ø v√† thi c√¥ng c·∫ßu ƒë∆∞·ªùng, h·∫° t·∫ßng giao th√¥ng',
        requirements: [
          'T·ªët nghi·ªáp ƒë·∫°i h·ªçc X√¢y d·ª±ng / C·∫ßu ƒë∆∞·ªùng',
          'C√≥ kinh nghi·ªám v·ªÅ c·∫ßu ƒë∆∞·ªùng',
          'Ti·∫øng Nh·∫≠t N2'
        ],
        benefits: [
          'L∆∞∆°ng cao',
          'D·ª± √°n l·ªõn',
          'H·ªçc h·ªèi c√¥ng ngh·ªá ti√™n ti·∫øn'
        ],
        salary: {
          min: 330000,
          max: 480000,
          currency: '¬•'
        },
        major: 'X√¢y d·ª±ng / C·∫ßu ƒë∆∞·ªùng',
        age: {
          min: 25,
          max: 42
        },
        language: 'Ti·∫øng Nh·∫≠t N2',
        recruitmentStatus: 'ƒêang tuy·ªÉn',
        isActive: true,
        order: 10
      },

      // Th√™m m·ªôt s·ªë job "Ng∆∞ng tuy·ªÉn" v√† "ƒê√£ ƒë√≥ng"
      {
        jobCode: 'TEST_1',
        title: 'Quality Control Specialist',
        category: 'C∆† KH√ç',
        location: 'Ho Chi Minh City, Vietnam',
        workType: 'Full-time',
        description: 'Ki·ªÉm so√°t ch·∫•t l∆∞·ª£ng s·∫£n ph·∫©m c∆° kh√≠',
        requirements: [
          'T·ªët nghi·ªáp ƒë·∫°i h·ªçc',
          'C√≥ kinh nghi·ªám QC'
        ],
        salary: {
          min: 250000,
          max: 350000,
          currency: '¬•'
        },
        recruitmentStatus: 'Ng∆∞ng tuy·ªÉn',
        isActive: true,
        order: 11
      },
      {
        jobCode: 'OLD_1',
        title: 'Senior Textile Engineer',
        category: 'C∆† KH√ç',
        location: 'Dong Nai, Vietnam',
        workType: 'Full-time',
        description: 'K·ªπ s∆∞ d·ªát may cao c·∫•p',
        requirements: [
          'Nhi·ªÅu nƒÉm kinh nghi·ªám'
        ],
        salary: {
          min: 300000,
          max: 400000,
          currency: '¬•'
        },
        recruitmentStatus: 'ƒê√£ ƒë√≥ng',
        isActive: false,
        order: 12
      }
    ];

    // T·∫°o jobs
    const createdJobs = await Job.insertMany(jobs);
    console.log(`‚úÖ Created ${createdJobs.length} jobs successfully!`);

    // Hi·ªÉn th·ªã t·ªïng h·ª£p theo category
    const summary = await Job.aggregate([
      { $group: { _id: '$category', count: { $sum: 1 } } },
      { $sort: { _id: 1 } }
    ]);

    console.log('\nüìä Jobs by category:');
    summary.forEach(({ _id, count }) => {
      console.log(`   ${_id}: ${count} jobs`);
    });

    // Hi·ªÉn th·ªã t·ªïng h·ª£p theo tr·∫°ng th√°i
    const statusSummary = await Job.aggregate([
      { $group: { _id: '$recruitmentStatus', count: { $sum: 1 } } },
      { $sort: { _id: 1 } }
    ]);

    console.log('\nüìä Jobs by status:');
    statusSummary.forEach(({ _id, count }) => {
      console.log(`   ${_id}: ${count} jobs`);
    });

    console.log('\n‚úÖ Seed completed successfully!');

    await mongoose.connection.close();
    console.log('üîí Database connection closed');

  } catch (error) {
    console.error('‚ùå Error seeding data:', error);
    process.exit(1);
  }
}

// Run seed
seedJobs();

